{% extends "layout/base.html" %}

{% block title %}Admin Dashboard{% endblock %}

{% block content %}

<div class="dashboard-header">
    <h1>Trang quáº£n trá»‹</h1>
    <p>Xin chÃ o <strong>{{ session.get('username', 'Admin') }}</strong></p>
</div>

<!-- Summary cards -->
<div class="dashboard-cards">
    <div class="card">
        <h3>{{ total_users }}</h3>
        <span>Tá»•ng Users</span>
    </div>

    <div class="card">
        <h3>{{ total_reports }}</h3>
        <span>Tá»•ng Reports</span>
    </div>

    <div class="card highlight">
        <h3>{{ active_users }}</h3>
        <span>User Ä‘ang hoáº¡t Ä‘á»™ng</span>
    </div>
</div>

<!-- Quick actions -->
<div class="dashboard-section">
    <h2>âš¡ Thao tÃ¡c nhanh</h2>
    <div class="quick-actions">
        <a href="{{ url_for('admin.create_user') }}" class="btn">â• ThÃªm user</a>
        <a href="{{ url_for('admin.create_report') }}" class="btn">â• ThÃªm report</a>
        <a href="{{ url_for('admin.users') }}" class="btn outline">ğŸ‘¤ Quáº£n lÃ½ user</a>
        <a href="{{ url_for('admin.reports') }}" class="btn outline">ğŸ“„ Quáº£n lÃ½ report</a>
    </div>
</div>

<!-- Latest reports -->
<div class="dashboard-section">
    <h2 class="dashboard-title">ğŸ“„ 5 Report má»›i nháº¥t</h2>
    <table class="dashboard-table">
        <thead>
            <tr>
                <th>STT</th>
                <th>TÃªn report</th>
                <th>HÃ nh Ä‘á»™ng</th>
            </tr>
        </thead>
        <tbody>
            {% for r in latest_reports %}
            <tr>
                <td>{{ loop.index }}</td>
                <td title="{{ r.ReportName }}" class="report-name">{{ r.ReportName }}</td>
                <td><a href="{{ r.FilePath }}" target="_blank" class="link">Xem</a></td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<div class="dashboard-section">
    <h2 class="dashboard-title">ğŸ“¥ Top 5 Report Ä‘Æ°á»£c táº£i nhiá»u nháº¥t</h2>

    <table class="dashboard-table">
        <thead>
            <tr>
                <th>STT</th>
                <th>TÃªn report</th>
                <th>Sá»‘ lÆ°á»£t táº£i</th>
            </tr>
        </thead>
        <tbody>
            {% for r in top_downloads %}
            <tr>
                <td>{{ loop.index }}</td>
                <td title="{{ r.ReportName }}" class="report-name">{{ r.ReportName }}</td>
                <td>{{ r.TotalDownloads }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<div class="dashboard-section">
    <h2 class="dashboard-title">ğŸ‘ï¸ Top 5 Report Ä‘Æ°á»£c xem nhiá»u nháº¥t</h2>

    <table class="dashboard-table">
        <thead>
            <tr>
                <th>STT</th>
                <th>TÃªn report</th>
                <th>Sá»‘ lÆ°á»£t Xem</th>
            </tr>
        </thead>
        <tbody>
            {% for r in top_views %}
            <tr>
                <td>{{ loop.index }}</td>
                <td title="{{ r.ReportName }}" class="report-name">{{ r.ReportName }}</td>
                <td>{{ r.TotalViews }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<div class="dashboard-section">
    <h2 class="dashboard-title">â¤ï¸ Top 5 Report Ä‘Æ°á»£c yÃªu thÃ­ch nhiá»u nháº¥t</h2>

    <table class="dashboard-table">
        <thead>
            <tr>
                <th>STT</th>
                <th>TÃªn report</th>
                <th>Sá»‘ lÆ°á»£t yÃªu thÃ­ch</th>
            </tr>
        </thead>
        <tbody>
            {% for r in top_favorites %}
            <tr>
                <td>{{ loop.index }}</td>
                <td title="{{ r.ReportName }}" class="report-name">{{ r.ReportName }}</td>
                <td>{{ r.TotalFavorites }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

{% endblock %}
